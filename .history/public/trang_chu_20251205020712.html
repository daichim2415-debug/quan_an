<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Food Shop - Đặt món nhanh</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        /* === RESET CSS === */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }
        body { background-color: #f8f9fa; color: #333; }

        /* === 1. HEADER (THANH MENU) === */
        header {
            background-color: #fff;
            padding: 15px 50px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            position: sticky; top: 0; z-index: 1000;
        }

        .logo {
            font-size: 26px; font-weight: 800; color: #ff6b6b; 
            text-decoration: none; display: flex; align-items: center; gap: 10px;
        }

        /* Thanh tìm kiếm */
        .search-bar {
            background: #f1f1f1; padding: 8px 15px; border-radius: 20px;
            display: flex; align-items: center; width: 400px;
        }
        .search-bar input {
            border: none; background: transparent; outline: none; 
            width: 100%; margin-left: 10px; font-size: 14px;
        }

        .nav-icons { display: flex; align-items: center; gap: 20px; }
        .nav-icons a { text-decoration: none; color: #333; font-weight: 600; font-size: 15px; transition: 0.3s; }
        .nav-icons a:hover { color: #ff6b6b; }

        /* Nút giỏ hàng nổi bật */
        .cart-btn {
            background: #ff6b6b; color: white !important;
            padding: 8px 20px; border-radius: 30px;
            display: flex; align-items: center; gap: 8px;
        }
        .cart-btn:hover { background: #ee5253; transform: translateY(-2px); }

        /* === 2. BANNER QUẢNG CÁO === */
        .banner {
            height: 350px;
            background: linear-gradient(to right, rgba(0,0,0,0.6), rgba(0,0,0,0.3)), 
                        url('https://images.unsplash.com/photo-1543353071-873f17a7a088?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80');
            background-size: cover; background-position: center;
            display: flex; align-items: center; justify-content: center;
            text-align: center; color: white;
        }
        .banner h1 { font-size: 45px; margin-bottom: 10px; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); }
        .banner p { font-size: 18px; opacity: 0.9; }

        /* === 3. KHU VỰC MÓN ĂN === */
        .container { max-width: 1200px; margin: 40px auto; padding: 0 20px; }
        
        .section-header { 
            display: flex; justify-content: space-between; align-items: center; 
            margin-bottom: 30px; border-bottom: 2px solid #eee; padding-bottom: 10px;
        }
        .section-title { font-size: 24px; color: #2d3436; font-weight: 700; }

        /* Lưới sản phẩm */
        .product-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 25px;
        }

        /* Thẻ Card món ăn */
        .food-card {
            background: white; border-radius: 12px; overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05); transition: 0.3s;
            position: relative; border: 1px solid #eee;
        }
        .food-card:hover { transform: translateY(-5px); box-shadow: 0 10px 25px rgba(0,0,0,0.1); }

        .food-card img { width: 100%; height: 180px; object-fit: cover; }

        .card-body { padding: 15px; }
        .food-name { font-size: 18px; font-weight: 700; margin-bottom: 5px; color: #2d3436; }
        .food-desc { font-size: 13px; color: #636e72; margin-bottom: 15px; height: 36px; overflow: hidden; }

        .card-footer { display: flex; justify-content: space-between; align-items: center; }
        .price { color: #ff6b6b; font-weight: 700; font-size: 18px; }

        .add-btn {
            background-color: #fff; border: 2px solid #ff6b6b; color: #ff6b6b;
            padding: 5px 12px; border-radius: 20px; cursor: pointer; font-weight: 600;
            transition: 0.3s;
        }
        .add-btn:hover { background-color: #ff6b6b; color: white; }

        /* Footer */
        footer { margin-top: 50px; background: #2d3436; color: white; padding: 30px; text-align: center; }
    </style>
</head>
<body>

    <header>
        <a href="#" class="logo"><i class="fas fa-utensils"></i> FoodShop</a>
        
        <div class="search-bar">
            <i class="fas fa-search" style="color: #999;"></i>
            <input type="text" placeholder="Bạn muốn ăn gì hôm nay?">
        </div>

       <nav class="nav-icons">
    <a href="login.html" id="user-account">
        <i class="far fa-user"></i> Đăng nhập
    </a>

    <a href="cart.html" class="cart-btn">
        <i class="fas fa-shopping-cart"></i> 
        <span>Giỏ hàng</span>
        <span id="cart-count" style="background: white; color: #ff6b6b; border-radius: 50%; padding: 1px 6px; font-size: 12px;">0</span>
    </a>
</nav>
    </header>

    <div class="banner">
        <div>
            <h1>Thế Giới Ẩm Thực</h1>
            <p>Freeship cho đơn hàng từ 100k - Giao siêu tốc</p>
        </div>
    </div>

    <div class="container">
        <div class="section-header">
            <h2 class="section-title">Thực Đơn Hôm Nay</h2>
        </div>

        <div id="product-list" class="product-grid">
            <div style="grid-column: 1/-1; text-align: center; padding: 20px;">
                <i class="fas fa-spinner fa-spin fa-2x" style="color: #ff6b6b;"></i>
                <p>Đang tải món ngon...</p>
            </div>
        </div>
    </div>

    <footer>
        <p>&copy; 2025 FoodShop Customer UI</p>
    </footer>

    <script>
    // 1. Hàm định dạng tiền tệ
    function formatMoney(amount) {
        return new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(amount);
    }

    // 2. Hàm lấy Key giỏ hàng (QUAN TRỌNG: Phải để lên đầu)
    function getCartKey() {
        const userJson = localStorage.getItem('currentUser');
        if (userJson) {
            const user = JSON.parse(userJson);
            return 'cart_' + user.username; // Ví dụ: cart_khach1
        }
        return 'shoppingCart'; // Giỏ hàng vãng lai
    }

    // 3. Lấy dữ liệu ngay khi vào trang (Dùng Key chuẩn vừa lấy)
    const currentKey = getCartKey();
    let cartData = JSON.parse(localStorage.getItem(currentKey)) || [];

    // 4. Hàm vẽ giỏ hàng ra màn hình
    function renderCart() {
        const wrapper = document.getElementById('cart-items-wrapper');
        const emptyMsg = document.getElementById('empty-cart-msg');
        const countSpan = document.getElementById('count-items');
        
        wrapper.innerHTML = '';
        let subtotal = 0;
        let totalItems = 0;

        // Nếu giỏ trống
        if (cartData.length === 0) {
            wrapper.style.display = 'none';
            emptyMsg.style.display = 'block';
            if(document.getElementById('subtotal')) document.getElementById('subtotal').innerText = '0 đ';
            if(document.getElementById('total-price')) document.getElementById('total-price').innerText = '0 đ';
            countSpan.innerText = 0;
            return;
        }

        // Nếu có món
        wrapper.style.display = 'block';
        emptyMsg.style.display = 'none';

        cartData.forEach((item, index) => {
            subtotal += item.price * item.quantity;
            totalItems += item.quantity;

            const html = `
                <div class="cart-item">
                    <div class="item-info">
                        <img src="${item.img}" alt="${item.name}" class="item-img" onerror="this.src='https://via.placeholder.com/100'">
                        <div class="item-details">
                            <h4>${item.name}</h4>
                            <p>${formatMoney(item.price)}</p>
                        </div>
                    </div>
                    <div class="quantity-controls">
                        <button class="qty-btn" onclick="updateQty(${index}, -1)"><i class="fas fa-minus"></i></button>
                        <span class="qty-value">${item.quantity}</span>
                        <button class="qty-btn" onclick="updateQty(${index}, 1)"><i class="fas fa-plus"></i></button>
                    </div>
                    <div class="remove-btn" onclick="removeItem(${index})">
                        <i class="fas fa-trash-alt"></i>
                    </div>
                </div>
            `;
            wrapper.innerHTML += html;
        });

        // Cập nhật tổng tiền
        document.getElementById('subtotal').innerText = formatMoney(subtotal);
        document.getElementById('total-price').innerText = formatMoney(subtotal + 15000); // Cộng phí ship
        countSpan.innerText = totalItems;
    }

    // 5. Hàm cập nhật số lượng
    function updateQty(index, change) {
        if (cartData[index].quantity + change > 0) {
            cartData[index].quantity += change;
        }
        saveAndRender();
    }

    // 6. Hàm xóa món
    function removeItem(index) {
        if (confirm('Bạn muốn xóa món này?')) {
            cartData.splice(index, 1); // Xóa khỏi mảng
            saveAndRender();
        }
    }

    // 7. Hàm Lưu và Vẽ lại (Dùng đúng Key hiện tại)
    function saveAndRender() {
        localStorage.setItem(currentKey, JSON.stringify(cartData));
        renderCart();
    }

    // --- CHẠY LẦN ĐẦU TIÊN ---
    renderCart();
</script>
</body>
</html>